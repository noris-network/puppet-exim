######################################################################
#                  Runtime configuration file for Exim               #
######################################################################


####################################################################
# This config file is managed by puppet. Manual editing of file is #
# strongly discouraged and might lead to unexpected behaviour!     #
####################################################################

keep_environment =

<% unless @macros.nil? -%>
<% @macros.each do |k,v| -%>
<%= k %>=<%= v %>
<% end -%>
<% end -%>
<% unless @includes.nil? -%>
<% @includes.each do |i| -%>
.include <%= i %>
<% end -%>
<% end -%>
<% unless @local_from_check.nil?                   -%>local_from_check                   = <%= @local_from_check %>
<% end -%>
<% unless @local_sender_retain.nil?                -%>local_sender_retain                = <%= @local_sender_retain %>
<% end -%>
<% unless @local_interfaces.nil?                   -%>local_interfaces                   = <; <%= @local_interfaces.join(" ; ") %>
<% end -%>
<% unless @daemon_smtp_ports.nil?                  -%>daemon_smtp_ports                  = <%= @daemon_smtp_ports.join(" : ") %>
<% end -%>
<% unless @tls_on_connect_ports.nil?               -%>tls_on_connect_ports               = <%= @tls_on_connect_ports.join(" : ") %>
<% end -%>
<% unless @disable_ipv6.nil?                       -%>disable_ipv6                       = <%= @disable_ipv6 %>
<% end -%>
<% unless @hosts_treat_as_local.nil?               -%>hosts_treat_as_local               = <%= @hosts_treat_as_local.join(" : ") %>
<% end -%>
<% unless @ldap_default_servers.nil?               -%>ldap_default_servers               = <%= @ldap_default_servers.join(" : ") %>
<% end -%>
<% unless @chunking_advertise_hosts.nil?           -%>chunking_advertise_hosts           = <%= @chunking_advertise_hosts.join(" : ") %>
<% end -%>
<% unless @queue_smtp_domains.nil?       -%>queue_smtp_domains             = <%= @queue_smtp_domains.join(" : ") %>
<% end -%>


log_selector               = <% unless @log_lost_incoming_connection.nil? -%><% unless @log_lost_incoming_connection.nil? == false -%> -lost_incoming_connection<% else %> +lost_incoming_connection<% end -%><% end -%>
<% unless @log_retry_defer.nil? -%><% unless @log_retry_defer.nil? == false -%> -retry_defer<% else %> +retry_defer<% end -%><% end -%>
<% unless @log_sender_on_delivery.nil? -%><% unless @log_sender_on_delivery.nil? == false -%> -sender_on_delivery<% else %> +sender_on_delivery<% end -%><% end -%>
<% unless @log_skip_delivery.nil? -%><% unless @log_skip_delivery.nil? == false -%> -skip_delivery<% else %> +skip_delivery<% end -%><% end -%>
<% unless @log_smtp_confirmation.nil? -%><% unless @log_smtp_confirmation.nil? == false -%> -smtp_confirmation<% else %> +smtp_confirmation<% end -%><% end -%>
<% unless @log_smtp_connection.nil? -%><% unless @log_smtp_connection.nil? == false -%> -smtp_connection<% else %> +smtp_connection<% end -%><% end -%>
<% unless @log_smtp_protocol_error.nil? -%><% unless @log_smtp_protocol_error.nil? == false -%> -smtp_protocol_error<% else %> +smtp_protocol_error<% end -%><% end -%>
<% unless @log_smtp_syntax_error.nil? -%><% unless @log_smtp_syntax_error.nil? == false -%> -smtp_syntax_error<% else %> +smtp_syntax_error<% end -%><% end -%>
<% unless @log_tls_peerdn.nil? -%><% unless @log_tls_peerdn.nil? == false -%> -tls_peerdn<% else %> +tls_peerdn<% end -%><% end -%>
<% unless @log_mail_subject.nil? -%><% unless @log_mail_subject.nil? == false -%> -subject<% else %> +subject<% end -%><% end -%>
<% unless @log_8bitmime.nil? -%><% unless @log_8bitmime.nil? == false -%> -8bitmime<% else %> +8bitmime<% end -%><% end -%>
<% unless @log_acl_warn_skipped.nil? -%><% unless @log_acl_warn_skipped.nil? == false -%> -acl_warn_skipped<% else %> +acl_warn_skipped<% end -%><% end -%>
<% unless @log_address_rewrite.nil? -%><% unless @log_address_rewrite.nil? == false -%> -address_rewrite<% else %> +address_rewrite<% end -%><% end -%>
<% unless @log_all_parents.nil? -%><% unless @log_all_parents.nil? == false -%> -all_parents<% else %> +all_parents<% end -%><% end -%>
<% unless @log_arguments.nil? -%><% unless @log_arguments.nil? == false -%> -arguments<% else %> +arguments<% end -%><% end -%>
<% unless @log_connection_reject.nil? -%><% unless @log_connection_reject.nil? == false -%> -connection_reject<% else %> +connection_reject<% end -%><% end -%>
<% unless @log_delay_delivery.nil? -%><% unless @log_delay_delivery.nil? == false -%> -delay_delivery<% else %> +delay_delivery<% end -%><% end -%>
<% unless @log_deliver_time.nil? -%><% unless @log_deliver_time.nil? == false -%> -deliver_time<% else %> +deliver_time<% end -%><% end -%>
<% unless @log_delivery_size.nil? -%><% unless @log_delivery_size.nil? == false -%> -delivery_size<% else %> +delivery_size<% end -%><% end -%>
<% unless @log_dnslist_defer.nil? -%><% unless @log_dnslist_defer.nil? == false -%> -dnslist_defer<% else %> +dnslist_defer<% end -%><% end -%>
<% unless @log_dnssec.nil? -%><% unless @log_dnssec.nil? == false -%> -dnssec<% else %> +dnssec<% end -%><% end -%>
<% unless @log_etrn.nil? -%><% unless @log_etrn.nil? == false -%> -etrn<% else %> +etrn<% end -%><% end -%>
<% unless @log_host_lookup_failed.nil? -%><% unless @log_host_lookup_failed.nil? == false -%> -host_lookup_failed<% else %> +host_lookup_failed<% end -%><% end -%>
<% unless @log_ident_timeout.nil? -%><% unless @log_ident_timeout.nil? == false -%> -ident_timeout<% else %> +ident_timeout<% end -%><% end -%>
<% unless @log_incoming_interface.nil? -%><% unless @log_incoming_interface.nil? == false -%> -incoming_interface<% else %> +incoming_interface<% end -%><% end -%>
<% unless @log_incoming_port.nil? -%><% unless @log_incoming_port.nil? == false -%> -incoming_port<% else %> +incoming_port<% end -%><% end -%>
<% unless @log_millisec.nil? -%><% unless @log_millisec.nil? == false -%> -millisec<% else %> +millisec<% end -%><% end -%>
<% unless @log_outgoing_interface.nil? -%><% unless @log_outgoing_interface.nil? == false -%> -outgoing_interface<% else %> +outgoing_interface<% end -%><% end -%>
<% unless @log_outgoing_port.nil? -%><% unless @log_outgoing_port.nil? == false -%> -outgoing_port<% else %> +outgoing_port<% end -%><% end -%>
<% unless @log_queue_run.nil? -%><% unless @log_queue_run.nil? == false -%> -queue_run<% else %> +queue_run<% end -%><% end -%>
<% unless @log_queue_time.nil? -%><% unless @log_queue_time.nil? == false -%> -queue_time<% else %> +queue_time<% end -%><% end -%>
<% unless @log_queue_time_overall.nil? -%><% unless @log_queue_time_overall.nil? == false -%> -queue_time_overall<% else %> +queue_time_overall<% end -%><% end -%>
<% unless @log_pid.nil? -%><% unless @log_pid.nil? == false -%> -pid<% else %> +pid<% end -%><% end -%>
<% unless @log_proxy.nil? -%><% unless @log_proxy.nil? == false -%> -proxy<% else %> +proxy<% end -%><% end -%>
<% unless @log_received_recipients.nil? -%><% unless @log_received_recipients.nil? == false -%> -received_recipients<% else %> +received_recipients<% end -%><% end -%>
<% unless @log_received_sender.nil? -%><% unless @log_received_sender.nil? == false -%> -received_sender<% else %> +received_sender<% end -%><% end -%>
<% unless @log_rejected_header.nil? -%><% unless @log_rejected_header.nil? == false -%> -rejected_header<% else %> +rejected_header<% end -%><% end -%>
<% unless @log_return_path_on_delivery.nil? -%><% unless @log_return_path_on_delivery.nil? == false -%> -return_path_on_delivery<% else %> +return_path_on_delivery<% end -%><% end -%>
<% unless @log_sender_verify_fail.nil? -%><% unless @log_sender_verify_fail.nil? == false -%> -sender_verify_fail<% else %> +sender_verify_fail<% end -%><% end -%>
<% unless @log_size_reject.nil? -%><% unless @log_size_reject.nil? == false -%> -size_reject<% else %> +size_reject<% end -%><% end -%>
<% unless @log_smtp_incomplete_transaction.nil? -%><% unless @log_smtp_incomplete_transaction.nil? == false -%> -smtp_incomplete_transaction<% else %> +smtp_incomplete_transaction<% end -%><% end -%>
<% unless @log_smtp_mailauth.nil? -%><% unless @log_smtp_mailauth.nil? == false -%> -smtp_mailauth<% else %> +smtp_mailauth<% end -%><% end -%>
<% unless @log_smtp_no_mail.nil? -%><% unless @log_smtp_no_mail.nil? == false -%> -smtp_no_mail<% else %> +smtp_no_mail<% end -%><% end -%>
<% unless @log_tls_certificate_verified.nil? -%><% unless @log_tls_certificate_verified.nil? == false -%> -tls_certificate_verified<% else %> +tls_certificate_verified<% end -%><% end -%>
<% unless @log_tls_cipher.nil? -%><% unless @log_tls_cipher.nil? == false -%> -tls_cipher<% else %> +tls_cipher<% end -%><% end -%>
<% unless @log_tls_sni.nil? -%><% unless @log_tls_sni.nil? == false -%> -tls_sni<% else %> +tls_sni<% end -%><% end -%>
<% unless @log_unknown_in_list.nil? -%><% unless @log_unknown_in_list.nil? == false -%> -unknown_in_list<% else %> +unknown_in_list<% end -%><% end -%>

<% unless @freeze_tell.nil?                        -%>freeze_tell                        = <%= @freeze_tell %>
<% end -%>
<% unless @message_logs.nil?                       -%>message_logs                       = <%= @message_logs %>
<% end -%>
<% unless @log_file_path.nil?                      -%>log_file_path                      = <%= @log_file_path.join(" : ") %>
<% end -%>
<% unless @syslog_timestamp.nil?                   -%>syslog_timestamp                   = <%= @syslog_timestamp %>
<% end -%>
<% unless @av_scanner.nil?                         -%>av_scanner                         = <%= @av_scanner %>
<% end -%>
<% unless @spamd_address.nil?                      -%>spamd_address                      = <%= @spamd_address %>
<% end -%>
<% unless @system_filter.nil?                      -%>system_filter                      = <%= @system_filter %>
<% end -%>
<% unless @split_spool_directory.nil?              -%>split_spool_directory              = <%= @split_spool_directory %>
<% end -%>
<% unless @check_spool_space.nil?                  -%>check_spool_space                  = <%= @check_spool_space %>
<% end -%>
<% unless @helo_allow_chars.nil?                   -%>helo_allow_chars                   = <%= @helo_allow_chars %>
<% end -%>
<% unless @allow_mx_to_ip.nil?                     -%>allow_mx_to_ip                     = <%= @allow_mx_to_ip %>
<% end -%>
<% unless @never_users.nil?                        -%>never_users                        = <%= @never_users.join(" : ") %>
<% end -%>
<% unless @trusted_users.nil?                      -%>trusted_users                      = <%= @trusted_users.join(" : ") %>
<% end -%>
<% unless @message_size_limit.nil?                 -%>message_size_limit                 = <%= @message_size_limit %>
<% end -%>
<% unless @host_lookup.nil?                        -%>host_lookup                        = <%= @host_lookup %>
<% end -%>
<% unless @untrusted_set_sender.nil?               -%>untrusted_set_sender               = <%= @untrusted_set_sender.join(" : ") %>
<% end -%>
<% unless @print_topbitchars.nil?                  -%>print_topbitchars                  = <%= @print_topbitchars %>
<% end -%>
<% unless @tls_require_ciphers.nil?                -%>tls_require_ciphers                = <%= @tls_require_ciphers %>
<% end -%>
<% unless @rfc1413_hosts.nil?                      -%>rfc1413_hosts                      = <%= @rfc1413_hosts %>
<% end -%>
<% unless @rfc1413_query_timeout.nil?              -%>rfc1413_query_timeout              = <%= @rfc1413_query_timeout %>
<% end -%>
<% unless @ignore_bounce_errors_after.nil?         -%>ignore_bounce_errors_after         = <%= @ignore_bounce_errors_after %>
<% end -%>
<% unless @timeout_frozen_after.nil?               -%>timeout_frozen_after               = <%= @timeout_frozen_after %>
<% end -%>
<% unless @auto_thaw.nil?                          -%>auto_thaw                          = <%= @auto_thaw %>
<% end -%>
<% unless @smtp_banner.nil?                        -%>smtp_banner                        = <%= @smtp_banner %>
<% end -%>
<% unless @smtp_receive_timeout.nil?               -%>smtp_receive_timeout               = <%= @smtp_receive_timeout %>
<% end -%>
<% unless @log_timezone.nil?                       -%>log_timezone                       = <%= @log_timezone %>
<% end -%>
<% unless @bounce_return_body.nil?                 -%>bounce_return_body                 = <%= @bounce_return_body %>
<% end -%>
<% unless @bounce_return_linesize_limit.nil?       -%>bounce_return_linesize_limit       = <%= @bounce_return_linesize_limit %>
<% end -%>
<% unless @bounce_return_message.nil?              -%>bounce_return_message              = <%= @bounce_return_message %>
<% end -%>
<% unless @bounce_return_size_limit.nil?           -%>bounce_return_size_limit           = <%= @bounce_return_size_limit %>
<% end -%>

<%- if @received_header_text.nil? -%>
received_header_text       = Received: \
  ${if def:sender_rcvhost {from $sender_rcvhost\n\t}\
  {${if def:sender_ident \
  {from ${quote_local_part:$sender_ident} }}\
  ${if def:sender_helo_name {(helo=$sender_helo_name)\n\t}}}}\
  by $primary_hostname \
  ${if def:received_protocol {with $received_protocol}} \
  ${if def:tls_cipher {($tls_cipher)\n\t}}\
  (Exim)\n\t\
  ${if def:sender_address \
  {(envelope-from <$sender_address>)\n\t}}\
  id $message_exim_id\
  ${if def:received_for {\n\tfor $received_for}}
<%- else -%>
received_header_text       = <%= @received_header_text %>
<%- end -%>

<% unless @exim_path.nil?                          -%>exim_path                          = <%= @exim_path %>
<% end -%>
<% unless @errors_reply_to.nil?                    -%>errors_reply_to                    = <%= @errors_reply_to %>
<% end -%>
<% unless @primary_hostname.nil?                   -%>primary_hostname                   = <%= @primary_hostname %>
<% end -%>
<% unless @qualify_domain.nil?                     -%>qualify_domain                     = <%= @qualify_domain %>
<% end -%>
<% unless @spool_directory.nil?                    -%>spool_directory                    = <%= @spool_directory %>
<% end -%>

<% unless @tls_advertise_hosts.nil? -%>
tls_advertise_hosts                = <%= @tls_advertise_hosts.join(" : ") %>
<% end -%>
<% unless @tls_certificate.nil? && @tls_privatekey.nil? -%>
tls_certificate                    = <%= @tls_certificate %>
tls_privatekey                     = <%= @tls_privatekey %>
<% end -%>

<% unless @prdr_enable.nil?                        -%>prdr_enable                        = <%= @prdr_enable %>
<% end -%>
<% unless @smtputf8_advertise_hosts.nil?           -%>smtputf8_advertise_hosts           = <%= @smtputf8_advertise_hosts %>
<% end -%>
<% unless @dns_dnssec_ok.nil?                      -%>dns_dnssec_ok                      = <%= @dns_dnssec_ok %>
<% end -%>
<% unless @gnutls_compat_mode.nil?                 -%>gnutls_compat_mode                 = <%= @gnutls_compat_mode %>
<% end -%>
<% unless @openssl_options.nil?                    -%>openssl_options                    = <%= @openssl_options %>
<% end -%>
<% unless @delay_warning.nil?                      -%>delay_warning                      = <%= @delay_warning %>
<% end -%>
<% unless @smtp_accept_max_nonmail.nil?            -%>smtp_accept_max_nonmail            = <%= @smtp_accept_max_nonmail %>
<% end -%>
<% unless @smtp_accept_max.nil?                    -%>smtp_accept_max                    = <%= @smtp_accept_max %>
<% end -%>
<% unless @smtp_accept_max_per_connection.nil?     -%>smtp_accept_max_per_connection     = <%= @smtp_accept_max_per_connection %>
<% end -%>
<% unless @smtp_accept_max_per_host.nil?           -%>smtp_accept_max_per_host           = <%= @smtp_accept_max_per_host %>
<% end -%>
<% unless @smtp_accept_queue.nil?                  -%>smtp_accept_queue                  = <%= @smtp_accept_queue %>
<% end -%>
<% unless @smtp_accept_queue_per_connection.nil?   -%>smtp_accept_queue_per_connection   = <%= @smtp_accept_queue_per_connection %>
<% end -%>
<% unless @smtp_accept_reserve.nil?                -%>smtp_accept_reserve                = <%= @smtp_accept_reserve %>
<% end -%>
<% unless @smtp_reserve_hosts.nil?                 -%>smtp_reserve_hosts                 = <%= @smtp_reserve_hosts.join(' : ') %>
<% end -%>
<% unless @smtp_return_error_details.nil?          -%>smtp_return_error_details          = <%= @smtp_return_error_details %>
<% end -%>
<% unless @deliver_queue_load_max.nil?             -%>deliver_queue_load_max             = <%= @deliver_queue_load_max %>
<% end -%>
<% unless @queue_only_load.nil?                    -%>queue_only_load                    = <%= @queue_only_load %>
<% end -%>
<% unless @queue_only.nil?                         -%>queue_only                         = <%= @queue_only %>
<% end -%>
<% unless @remote_max_parallel.nil?                -%>remote_max_parallel                = <%= @remote_max_parallel %>
<% end -%>
<% unless @queue_run_max.nil?                      -%>queue_run_max                      = <%= @queue_run_max %>
<% end -%>
<% unless @callout_domain_positive_expire.nil?     -%>callout_domain_positive_expire     = <%= @callout_domain_positive_expire %>
<% end -%>
<% unless @extract_addresses_remove_arguments.nil? -%>extract_addresses_remove_arguments = <%= @extract_addresses_remove_arguments %>
<% end -%>
<% unless @mysql_servers.nil?                       -%>hide mysql_servers                = <%= @mysql_servers.map{|i| i.gsub(':', '::')}.join(" : ") %>
<% end -%>
<% unless @gecos_name.nil?                          -%>gecos_name                        = <%= @gecos_name %>
<% end -%>
<% unless @gecos_pattern.nil?                       -%>gecos_pattern                     = <%= @gecos_pattern %>
<% end -%>
